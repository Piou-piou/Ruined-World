<script>
	$(document).ready(function() {
		$("#login-form").submit(function(e) {
			if ($("#login-form #vacances").val() != "desactiver") {
                e.preventDefault();
                $.ajax({
                    type:"POST",
                    data: $(this).serialize(),
                    url:"{{WEBROOT}}controller/modules/bataille/auth/login_ajax",
                    success: function(data){
                        if (data == "ok") {
                            $.ajax({
                                type:"POST",
                                data: $(this).serialize(),
                                url:"{{WEBROOT}}controller/modules/bataille/auth/login",
                                success: function(data) {
                                    $("body").append(data);
                                    $("body .login:first-of-type").remove();
                                }
                            });
                        }
                        else if (data == "popup") {
                            $("#popup-vacances").addClass("visible");
                        }
                        else {
                            $("body").prepend(data);
                        }
                    }
                });
			}
		});
		
		$(".popup a.valider").click(function(e) {
		    e.preventDefault();
            
            $("#login-form #vacances").val("desactiver");
            
            $("#login-form").submit();
		})
	});
</script>